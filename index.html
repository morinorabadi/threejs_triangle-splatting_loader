<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Triangle Splatting Viewer</title>
  </head>
  <body class="m-0 h-full w-full overflow-hidden bg-black font-sans text-white">
    <div class="relative h-full w-full">
      <canvas id="canvas" class="block h-full w-full"></canvas>

      <div
        id="loading"
        class="fixed left-1/2 top-1/2 z-200 hidden -translate-x-1/2 -translate-y-1/2 rounded-xl bg-black/80 px-8 py-7 text-center text-white"
      >
        <p class="text-lg">Loading model...</p>
        <p id="loadingStatus" class="mt-1 text-sm text-white/80">
          Initializing...
        </p>
      </div>

      <div
        id="ui"
        class="absolute left-5 top-5 z-100 w-75 max-w-[calc(100vw-2.5rem)] rounded-lg bg-black/70 p-4 text-sm text-white shadow-lg backdrop-blur-sm"
      >
        <h2 class="mb-2 text-base font-semibold tracking-wide">
          Triangle Splatting
        </h2>
        <p class="my-1">Model: <span id="modelName">None</span></p>
        <p class="my-1">Triangles: <span id="triangleCount">0</span></p>
        <p class="my-1">Points: <span id="pointCount">0</span></p>
        <p class="my-1">Status: <span id="statusText">Idle</span></p>

        <label
          for="renderMode"
          class="mt-3 block text-xs uppercase tracking-wide text-white/80"
          >Render Mode</label
        >
        <select
          id="renderMode"
          title="Render mode"
          class="mt-1 w-full rounded border border-white/20 bg-black/70 px-2 py-1 text-sm text-white outline-none ring-emerald-400/60 focus:ring"
        >
          <option value="splat" selected>Splat (Experimental)</option>
          <option value="mesh">Mesh</option>
        </select>

        <label
          for="alphaCurve"
          class="mt-3 block text-xs uppercase tracking-wide text-white/80"
          >Splat Opacity Boost (k): <span id="alphaCurveValue">1.0</span></label
        >
        <input
          type="range"
          id="alphaCurve"
          min="1"
          max="60"
          step="0.5"
          value="1"
          title="Alpha curve boost for splat mode"
          class="mt-1 w-full accent-emerald-500"
        />

        <label
          for="sigmaScale"
          class="mt-3 block text-xs uppercase tracking-wide text-white/80"
          >Splat Sigma Scale: <span id="sigmaScaleValue">0.35</span></label
        >
        <input
          type="range"
          id="sigmaScale"
          min="0.05"
          max="1.00"
          step="0.01"
          value="0.35"
          title="Lower values are sharper/more solid"
          class="mt-1 w-full accent-emerald-500"
        />

        <label
          for="alphaFloor"
          class="mt-3 block text-xs uppercase tracking-wide text-white/80"
          >Covered Alpha Floor: <span id="alphaFloorValue">0.00</span></label
        >
        <input
          type="range"
          id="alphaFloor"
          min="0.00"
          max="0.80"
          step="0.01"
          value="0.00"
          title="Minimum alpha where splat coverage exists"
          class="mt-1 w-full accent-emerald-500"
        />

        <input
          type="file"
          id="fileInput"
          accept=".tgsp,.tsgd,.tgsd"
          title="Load TGSP/TSGD file"
          class="mt-3 block w-full cursor-pointer text-xs text-white/80 file:mr-3 file:rounded file:border-0 file:bg-emerald-600 file:px-3 file:py-1.5 file:text-xs file:font-medium file:text-white hover:file:bg-emerald-500"
        />
      </div>

      <div
        class="absolute bottom-5 right-5 z-100 rounded bg-black/70 px-3 py-2 font-mono text-xs text-lime-400"
      >
        <div>FPS: <span id="fps">0</span></div>
        <div>Triangles: <span id="renderedTriangles">0</span></div>
        <div>Points: <span id="renderedPoints">0</span></div>
      </div>

      <div
        class="absolute bottom-5 left-1/2 z-100 flex -translate-x-1/2 items-center gap-4 rounded bg-black/55 px-3 py-2 text-xs text-white/80 backdrop-blur-sm"
      >
        <a
          href="https://github.com/morinorabadi/threejs_triangle-splatting_loader"
          class="underline decoration-white/40 underline-offset-2 hover:text-white"
          >source</a
        >
        <a
          href="/export_tgsp.py"
          download="export_tgsp.py"
          class="underline decoration-white/40 underline-offset-2 hover:text-white"
          >tgsp exporter</a
        >
        <a
          href="/garden.tgsp"
          download="garden.tgsp"
          class="underline decoration-white/40 underline-offset-2 hover:text-white"
          >test tgsp file (garden)</a
        >
        <a
          href="/garden.pth"
          download="garden.pth"
          class="underline decoration-white/40 underline-offset-2 hover:text-white"
          >traned model (garden.pth)</a
        >
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
